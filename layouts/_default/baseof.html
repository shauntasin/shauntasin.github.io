<!doctype html>
<html lang="en">
<head>
  {{ partial "head.html" . }}
</head>
<body class="theme-mechatronics {{ if .IsHome }}booting{{ end }}">
  {{ if .IsHome }}
  <section id="boot" class="boot-screen" aria-hidden="true">
    <pre class="boot-text">[ SHAUNTASIN // MECHATRONICS CONSOLE v2.6 ]
BOOT SEQUENCE .......... OK
SERVO BUS .............. ONLINE
SENSOR ARRAY ........... ONLINE
TERMINAL LINK .......... READY
EXECUTE: load_home()</pre>
  </section>
  {{ end }}

  <main class="wrap">
    <header class="topbar">
      <a class="brand" href="/">{{ .Site.Title }}</a>
      <nav class="nav-links">
        <a href="/">home</a>
        <a href="/about/">about</a>
      </nav>
      <button id="themeToggle" class="theme-toggle" type="button" aria-label="Toggle theme">newsboat mode</button>
      <span class="cursor">_</span>
    </header>
    {{ block "main" . }}{{ end }}
    <footer class="foot">© {{ now.Year }} {{ .Site.Title }} · built with Hugo</footer>
  </main>

  {{ if .IsHome }}
  <script>
    window.addEventListener('load', function () {
      const boot = document.getElementById('boot');
      setTimeout(() => {
        document.body.classList.remove('booting');
        if (boot) boot.classList.add('hide');
      }, 1400);
    });
  </script>
  {{ end }}

  <script>
    (function () {
      const key = 'site-theme';
      const btn = document.getElementById('themeToggle');
      const apply = (theme) => {
        document.body.classList.remove('theme-mechatronics', 'theme-newsboat');
        document.body.classList.add(theme === 'newsboat' ? 'theme-newsboat' : 'theme-mechatronics');
        if (btn) btn.textContent = theme === 'newsboat' ? 'mechatronics mode' : 'newsboat mode';
      };

      const saved = localStorage.getItem(key);
      apply(saved === 'newsboat' ? 'newsboat' : 'mechatronics');

      if (btn) {
        btn.addEventListener('click', function () {
          const next = document.body.classList.contains('theme-newsboat') ? 'mechatronics' : 'newsboat';
          localStorage.setItem(key, next);
          apply(next);
        });
      }
    })();
  </script>
</body>
</html>
